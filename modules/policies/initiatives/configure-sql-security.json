{
  "properties": {
    "displayName": "Configure SQL security",
    "policyType": "Custom",
    "description": "Configure SQL security",
    "metadata": {
      "version": "1.0.0",
      "category": "SQL"
    },
    "parameters": {
      "logAnalyticsWorkspaceId": {
        "type": "String",
        "metadata": {
          "strongType": "Microsoft.OperationalInsights/workspaces"
        }
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "configure-sql-servers-to-have-auditing-enabled-to-log-analytics-workspace",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/25da7dfb-0666-4a15-a8f5-402127efd8bb",
        "parameters": {
          "logAnalyticsWorkspaceId": {
            "value": "[parameters('logAnalyticsWorkspaceId')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "configure-advanced-threat-protection-to-be-enabled-on-azure-database-for-postgresql-servers",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/db048e65-913c-49f9-bb5f-1084184671d3",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "configure-advanced-threat-protection-to-be-enabled-on-azure-database-for-mysql-servers",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/80ed5239-4122-41ed-b54a-6f1fa7552816",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "deploy-advanced-data-security-on-sql-servers",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6134c3db-786f-471e-87bc-8f479dc890f6",
        "parameters": {},
        "groupNames": []
      }
    ],
    "policyDefinitionGroups": []
  },
  "type": "Microsoft.Authorization/policySetDefinitions",
  "name": "configure-sql-security"
}
