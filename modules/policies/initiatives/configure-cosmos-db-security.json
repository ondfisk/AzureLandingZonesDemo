{
  "properties": {
    "displayName": "Configure Cosmos DB security",
    "policyType": "Custom",
    "description": "Configure Cosmos DB security",
    "metadata": {
      "version": "1.0.0",
      "category": "SQL"
    },
    "parameters": {
      "logAnalyticsWorkspaceId": {
        "type": "String",
        "metadata": {
          "strongType": "Microsoft.OperationalInsights/workspaces"
        }
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "configure-sql-servers-to-have-auditing-enabled-to-log-analytics-workspace",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/25da7dfb-0666-4a15-a8f5-402127efd8bb",
        "parameters": {
          "logAnalyticsWorkspaceId": {
            "value": "[parameters('logAnalyticsWorkspaceId')]"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "configure-cosmos-db-database-accounts-to-disable-local-authentication",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/dc2d41d1-4ab1-4666-a3e1-3d51c43e0049",
        "parameters": {},
        "groupNames": []
      }
    ],
    "policyDefinitionGroups": []
  },
  "type": "Microsoft.Authorization/policySetDefinitions",
  "name": "configure-cosmos-db-security"
}
